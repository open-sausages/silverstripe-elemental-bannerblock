!function(e){function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var t={};n.m=e,n.c=t,n.i=function(e){return e},n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},n.p="",n(n.s=5)}([function(e,n,t){"use strict";function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function r(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n}function o(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)}Object.defineProperty(n,"__esModule",{value:!0}),t.d(n,"Component",function(){return p});var a=t(2),l=t.n(a),c=t(1),s=(t.n(c),t(9)),u=t.n(s),f=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}(),p=function(e){function n(e){i(this,n);var t=r(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return t.handleChangeValue=t.handleChangeValue.bind(t),t}return o(n,e),f(n,[{key:"getOptionByValue",value:function(e){return this.props.actions.find(function(n){return n.value===e})}},{key:"handleChangeValue",value:function(e){var n=this.getOptionByValue(e.target.value);return void 0===n?null:"function"==typeof n.confirm?n.confirm().then(function(){return n.callback()}).catch(function(e){if("cancelled"!==e)throw e}):n.callback()||Promise.resolve()}},{key:"render",value:function(){var e=this,n=this.props.actions.map(function(n){var t=u()("block-link-field__action","dropdown-item",n.className||"");return l.a.createElement("button",{type:"button",className:t,key:n.value,onClick:e.handleChangeValue,value:n.value},n.label)}).filter(function(e){return e});if(!n.length)return null;var t=this.props.ActionMenu;return l.a.createElement("div",{className:"block-link-field-actions fieldholder-small input-group"},l.a.createElement(t,{id:this.props.id,className:"block-link-field-actions__menu",container:this.props.container},n))}}]),n}(a.Component);p.propTypes={id:l.a.PropTypes.string.isRequired,actions:l.a.PropTypes.arrayOf(l.a.PropTypes.shape({value:l.a.PropTypes.string.isRequired,label:l.a.PropTypes.string.isRequired,className:l.a.PropTypes.string,destructive:l.a.PropTypes.bool,callback:l.a.PropTypes.func,canApply:l.a.PropTypes.func,confirm:l.a.PropTypes.func})),ActionMenu:l.a.PropTypes.oneOfType([l.a.PropTypes.node,l.a.PropTypes.func])},p.defaultProps={id:"",actions:[],ActionMenu:null},n.default=t.i(c.inject)(["ActionMenu"],function(e){return{ActionMenu:e}},function(){return"BlockLinkFieldActions"})(p)},function(e,n){e.exports=Injector},function(e,n){e.exports=React},function(e,n){e.exports=i18n},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=t(10),r=t.n(i),o=t(3),a=t.n(o),l=t(2),c=t.n(l),s=t(8),u=t.n(s),f=t(0),p=t(6),d=t(1),h=(t.n(d),t(7)),k=(t.n(h),Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}),g="insert-link__dialog-wrapper--internal",v=g+"-no-tinymce",y=t.i(d.provideInjector)(f.default),b=t.i(d.loadComponent)(t.i(h.createInsertLinkModal)("SilverStripe\\CMS\\Controllers\\CMSPageEditController","editorInternalLink"));r.a.entwine("ss",function(e){e(".form__field-holder .block-link-field").entwine({getDialogWrapper:function(){return e("#"+g)},createDialog:function(){var n=this.getDialogWrapper();n.length||(n=e('<div id="'+g+'" />').addClass("insert-link__dialog-wrapper"),e("body").append(n))},onmatch:function(){this.createDialog()},onclick:function(n){var t=this;e(n.target).is("button")||u.a.render(c.a.createElement(b,{isOpen:!0,onInsert:function(e){return alert("You linked to page ID "+e.PageID)},onClosed:function(){return u.a.unmountComponentAtNode(t[0])},identifier:"Admin.InsertLinkInternalModal"}),this[0])},registerChange:function(){this.find(".block-link-field__content").empty().append(e("<span/>").addClass("block-link-field__content--message").text(a.a._t("BlockLinkField.ModifiedMessage","Changes will be visible upon save")))}}),e(".js-injector-boot .block-link-field__actions").entwine({getLinkField:function(){return this.parent(".block-link-field")},getLinkDataField:function(){return this.getLinkField().find("input:hidden.block-link-field")},onmatch:function(){var e=JSON.parse(this.getLinkDataField().val());e&&void 0!==e.PageID&&this.renderActionsMenu()},renderActionsMenu:function(){var n=this,t=p.a.LINK_ACTIONS.map(function(t){if(t.callback)return t;switch(t.value){case"clear":return k({},t,{callback:function(){n.getLinkDataField().val("{}"),n.getLinkField().registerChange(),n.remove(),e("#"+n.find(".btn").attr("aria-controls")).remove()}});default:return t}});u.a.render(c.a.createElement(y,{id:this.getLinkDataField().attr("name")+"_Popover",actions:t,container:this.closest("form")[0]}),this[0])}}),e("#"+g).entwine({isTinyMce:function(){return!this.hasClass(v)},getRequireLinkText:function(){if(this.isTinyMce())return this._super();var e=this.getLinkDataField();return void 0===e||void 0===e.data("showlinktext")||!!+e.data("showlinktext")},getLinkDataField:function(){var n=this.data("datafield-name");return e('input[name="'+n+'"]')},getDataFromLinkField:function(){var e=this.getLinkDataField(),n={};if(void 0!==e)try{n=JSON.parse(e.val())}catch(e){}return n||(n={}),n},setDataToLinkField:function(e){var n=this.getLinkDataField();if(n){var t={},i=Object.keys(e).filter(function(e){return["PageID","Anchor","Text","Description","TargetBlank"].includes(e)}).reduce(function(n,i){return t[i]=e[i],t},{});n.val(JSON.stringify(i))}},getModalTitle:function(){return e(".modal."+g).find(".modal-title")},updateModalTitle:function(e){this.getModalTitle().text(e)},getLinkAttributes:function(){var e=this.getDataFromLinkField();return{PageID:e.PageID||0,Anchor:e.Anchor||"",Text:e.Text||"",Description:e.Description||"",TargetBlank:e.TargetBlank||!1}},handleInsert:function(e){return this.isTinyMce()?this._super(e):(this.setDataToLinkField(e),this.close(),Promise.resolve())},getOriginalAttributes:function(){return this.isTinyMce()?this._super():this.getLinkAttributes()},updateFormField:function(){this.getLinkDataField().parent("div.block-link-field").registerChange()},close:function(){var e=this._super();return this.removeClass(v),this.updateFormField(),e}})})},function(e,n,t){t(4),t(0)},function(e,n,t){"use strict";var i=t(3),r=t.n(i);n.a={LINK_ACTIONS:[{value:"clear",label:r.a._t("BlockLinkField.ClearLink","Clear link"),className:"",destructive:!0,canApply:function(){return!0},callback:null}]}},function(e,n){e.exports=InsertLinkModal},function(e,n){e.exports=ReactDom},function(e,n){e.exports=classnames},function(e,n){e.exports=jQuery}]);